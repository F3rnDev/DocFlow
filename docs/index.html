<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="description" content="Description">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsify-themeable@0/dist/css/theme-simple-dark.css">
</head>
<body>

  <!-- langPicker, custom asset -->
  <nav>
    <select id="langPicker" onchange="redirecionarPagina()">
      <option value="pt-br">por</option>
      <option value="en-us">eng</option>
    </select>
  </nav>

  <div id="app"></div>
  <script>
    window.$docsify = {
      name: 'Docflow',
      repo: 'https://github.com/F3rnDev/DocFlow',
      homepage: 'home.md'
    }
  </script>

  <!-- Docsify v4 -->
  <script src="//cdn.jsdelivr.net/npm/docsify@4"></script>

  <!-- docflow langPicker code -->
  <script> 
    document.addEventListener("DOMContentLoaded", function() {
      var lang = window.location.pathname;
      var userLang = navigator.language.toLowerCase();

      var langCheck = lang.replace("DocFlow", "").replace("/", "")

      console.log(langCheck);

      if (langCheck == "")
      {
        if (languageExists(userLang)){
          lang = userLang;
        }
        else {
          lang = "en-us";
        }

        window.location.href = "#/" + lang + "/home";
      }

      document.getElementById("langPicker").value = lang;
    });

    function languageExists(lang) {
      var langs = langPicker.options;
      for (var i = 0; i < langs.length; i++) {
        if (langs[i].value == lang) {
          return true;
          break;
        }
      }

      return false;
    }

    function getWindowLocation() {
      var splitRef = window.location.href.split('#')[1];
      var langs = langPicker.options;

      var lang = "";

      for (var i = 0; i < langs.length; i++) {
        if (splitRef.includes(langs[i].value)) 
        {
          lang = langs[i].value;
          break;
        }
      }

      splitRef = splitRef.replace(lang, "").replace("/", "");

      return splitRef;
    }
  
    function redirecionarPagina() {
      var lang = document.getElementById("langPicker").value;

      var curUrlRef = "#/" + lang;
      var windowLocation = getWindowLocation();

      window.location.href = curUrlRef + windowLocation;
    }
  </script>
</body>
</html>
